# 职场情绪充电站 - 分享使用指南

## 🎯 概述

职场情绪充电站是一个基于Coze平台的AI Agent，为职场人士提供命理分析、MBTI性格分析、运势趋势图、人际关系指导和职业转型建议等服务。

## 🚀 快速开始

### 方式一：本地运行（适合个人测试）

#### 1. 启动HTTP服务

```bash
# 在项目根目录下执行
bash scripts/http_run.sh -p 8000
```

#### 2. 访问Web界面

打开浏览器，访问：
```
http://localhost:8000
```

#### 3. 使用功能

- **欢迎语**：一进入就能看到欢迎界面和功能介绍
- **快捷按钮**：点击上方的5个功能按钮快速开始
  - 🔮 命理分析
  - 🧠 MBTI分析
  - 📈 运势趋势图
  - 👥 人际关系
  - 💼 职业转型
- **自由对话**：在聊天框中输入任何问题

### 方式二：分享给他人测试（推荐）

#### 1. 部署到公网服务器

你需要将Agent部署到一个公网可访问的服务器上。以下是几种推荐方案：

##### 方案A：使用Coze平台部署（推荐）

1. 登录Coze平台
2. 将项目代码上传到Coze工作区
3. 配置环境变量和依赖
4. 启动HTTP服务（端口8000）
5. Coze会自动分配一个公网访问地址

##### 方案B：使用云服务器部署

1. 购买云服务器（阿里云、腾讯云、AWS等）
2. 安装Python环境和依赖
3. 上传项目代码
4. 启动HTTP服务：
   ```bash
   nohup bash scripts/http_run.sh -p 8000 > server.log 2>&1 &
   ```
5. 配置防火墙，开放8000端口
6. 通过服务器的公网IP访问：
   ```
   http://your-server-ip:8000
   ```

##### 方案C：使用内网穿透工具（临时测试）

如果你只是在局域网内测试，可以使用内网穿透工具：

**使用frp（示例）**

服务器端配置（frps.ini）：
```ini
[common]
bind_port = 7000
```

客户端配置（frpc.ini）：
```ini
[common]
server_addr = your-server-ip
server_port = 7000

[web]
type = http
local_port = 8000
custom_domains = your-domain.com
```

启动客户端后，通过域名访问你的Agent。

#### 2. 生成分享链接

部署成功后，你会得到一个访问地址，例如：
```
http://your-domain.com:8000
```

将这个链接分享给你的朋友或同事即可。

#### 3. 注意事项

⚠️ **重要提醒**：

1. **API额度限制**：外部API（八字、紫微斗数）有免费额度限制，大量并发调用可能导致降级到联网搜索模式
2. **性能考虑**：如果分享给多人同时使用，建议：
   - 使用配置更高的服务器
   - 配置负载均衡
   - 使用Redis缓存频繁查询的结果
3. **安全设置**：
   - 不要在公网直接暴露服务器的敏感端口
   - 定期更新系统和依赖包
   - 配置访问日志，监控异常请求

## 📱 移动端访问

Web界面支持响应式设计，在手机和平板上也能完美显示：

1. 在手机浏览器中输入分享链接
2. 界面会自动适配屏幕大小
3. 功能按钮和聊天界面均可正常使用

## 🔧 环境配置

### 必需环境变量

确保以下环境变量已正确配置：

```bash
# Coze平台相关
export COZE_WORKLOAD_IDENTITY_API_KEY=your_api_key
export COZE_INTEGRATION_MODEL_BASE_URL=https://your-model-url

# 数据库配置（可选）
export SUPABASE_URL=your_supabase_url
export SUPabase_KEY=your_supabase_key
```

### 安装依赖

```bash
pip install -r requirements.txt
```

## 🐛 常见问题

### Q1：访问页面显示404错误

**原因**：静态文件目录不存在或未正确挂载

**解决方案**：
1. 检查`src/static`目录是否存在
2. 检查`index.html`文件是否在`src/static`目录下
3. 重启HTTP服务

### Q2：功能按钮点击无响应

**原因**：API端点未正确配置

**解决方案**：
1. 检查浏览器控制台是否有错误
2. 确认`/api/stream`端点是否正常工作
3. 检查Agent是否正常运行

### Q3：AI回复很慢

**原因**：模型推理需要时间，或外部API响应慢

**解决方案**：
1. 等待AI处理完成（通常5-10秒）
2. 检查网络连接
3. 查看服务器日志是否有错误

### Q4：运势趋势图无法显示

**原因**：QuickChart API调用失败

**解决方案**：
1. 检查网络是否能访问外部API
2. 查看Agent日志中的具体错误信息
3. 尝试刷新页面重新生成

## 📊 功能演示

### 功能1：命理分析

点击"命理分析"按钮，或输入"请帮我分析今天的运势"，AI会：

- 根据你的八字或紫微斗数进行分析
- 提供事业、财运、健康等方面的建议
- 给出今日吉时、吉位等实用信息

### 功能2：MBTI分析

点击"MBTI分析"按钮，或输入"我的MBTI类型是？如何提升职场表现？"，AI会：

- 分析你的MBTI性格特点
- 提供针对性的职场建议
- 结合命理信息给出综合建议

### 功能3：运势趋势图

点击"运势趋势图"按钮，或输入"生成我本月的运势趋势图"，AI会：

- 生成可视化的运势趋势图
- 标注关键时间节点
- 提供相应的行动建议

### 功能4：人际关系

点击"人际关系"按钮，或输入"如何与不同性格的同事更好沟通？"，AI会：

- 分析不同性格类型的沟通特点
- 提供具体的沟通策略
- 结合MBTI和命理信息给出个性化建议

### 功能5：职业转型

点击"职业转型"按钮，或输入"我想进行职业转型，有什么建议？"，AI会：

- 分析你当前的职业状况
- 识别可迁移技能
- 提供转型路径和学习建议
- 结合命理分析转型时机

## 🎨 自定义配置

### 修改欢迎语

编辑`src/static/index.html`中的欢迎区域：

```html
<div class="welcome-section">
    <h1>✨ 你的标题 ✨</h1>
    <p class="subtitle">你的副标题</p>
    ...
</div>
```

### 修改功能按钮

编辑`src/static/index.html`中的功能按钮区域：

```html
<button class="feature-btn" data-prompt="你的提示词">
    <span class="icon">🔮</span>
    <span class="text">按钮名称</span>
</button>
```

### 修改样式

编辑`src/static/css/style.css`来自定义界面样式。

### 修改Agent配置

编辑`config/agent_llm_config.json`来调整：

- 使用的模型
- 温度参数
- 最大tokens
- 系统提示词

## 📝 日志查看

查看HTTP服务日志：
```bash
tail -f /tmp/http_server.log
```

查看Agent运行日志：
```bash
tail -f /app/work/logs/bypass/app.log
```

## 🚀 性能优化

1. **启用缓存**：对频繁查询的结果进行缓存
2. **使用CDN**：将静态资源托管到CDN
3. **压缩资源**：启用Gzip压缩
4. **负载均衡**：使用Nginx配置负载均衡

## 🔐 安全建议

1. 不要在生产环境使用默认端口（8000）
2. 配置HTTPS证书
3. 启用访问频率限制
4. 定期备份重要数据
5. 监控异常访问

## 📞 获取帮助

如果遇到问题，请：

1. 查看日志文件
2. 检查环境变量配置
3. 查看错误信息和堆栈跟踪
4. 参考Coze平台文档

---

**最后更新时间**：2025-01-02
**版本**：1.0.0
