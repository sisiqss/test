# 花名册功能使用指南

## 简介

花名册功能用于管理用户及其社交关系信息，包括本人、同事、父母、儿女、朋友等。Agent可以根据花名册中的信息提供更加个性化的服务。

## 快速开始

### 1. 首次使用

当你首次使用Agent时，会要求你提供个人信息：

```
🌟 欢迎来到职场情绪充电站！🌟

我是你的专属职场导师，将为你提供命理分析、职场建议、MBTI性格分析和情绪支持服务。

为了给你提供最贴心的个性化服务，请告诉我以下信息：

📋 【基本信息】
1. 你的姓名（可以只告诉我昵称）
2. 你的性别（男/女）
3. MBTI类型（可选，如INTJ、ENFP）

🎯 【命理信息】（用于运势分析）
4. 出生年月日时（如：1990年03月15日08时）
5. 出生地理位置（如：北京，可留空使用当前位置）

💼 【职场信息】（用于职业建议）
6. 当前地理位置（用于天气和穿搭建议）
7. 行业（如：互联网、金融、教育）
8. 职位（如：产品经理、软件工程师）
9. 职级（如：P6、P7、高级、经理）

你可以一次性告诉我，也可以逐条提供～ 😊
```

### 2. 提供信息

```
用户：我叫张三，男，1990年3月15日8点出生，INTJ，现在在北京，互联网行业产品经理
```

Agent会自动将你的信息保存到花名册，并生成完整的分析报告。

## 关系类型

花名册支持以下关系类型：

| 关系类型 | 说明 | 必填字段 |
|---------|------|---------|
| 本人 | 自己 | 姓名、性别、出生年月日时间、现居地 |
| 同事 | 同事 | 姓名、性别、现居地、关系级别（可选） |
| 父母 | 父亲或母亲 | 姓名、性别、现居地 |
| 儿女 | 儿子或女儿 | 姓名、性别、现居地 |
| 朋友 | 朋友 | 姓名、性别、现居地 |
| 其他 | 其他关系 | 姓名、性别、现居地 |

## 同事关系级别

对于同事，可以标注关系级别：

| 级别 | 说明 | 示例 |
|-----|------|-----|
| +2 | 上两级（领导的领导） | 总经理、副总裁 |
| +1 | 上一级（直接领导） | 部门经理、组长 |
| 0 | 平级 | 同事、同组 |
| -1 | 下一级（直接下属） | 下属、实习生 |
| -2 | 下两级（下属的下属） | 下属的下属 |

## 使用场景

### 场景1：添加同事

```
用户：帮我添加我的同事李四的信息，她是我的部门经理
Agent：好的，我来帮你添加李四的信息。
      请提供以下信息：
      1. 性别
      2. 现居地
      3. MBTI类型（可选）

用户：女，上海，ENFP
Agent：✅ 添加成功！

**姓名**: 李四
**关系**: 同事 (+1)
**性别**: 女
**现居地**: 上海
**MBTI**: ENFP

李四已添加到你的花名册！
```

### 场景2：添加父母

```
用户：添加我父母的信息，父亲叫王建国，母亲叫李桂英
Agent：好的，我来帮你添加父母的信息。
      请提供以下信息：
      1. 他们的现居地

用户：都在杭州
Agent：✅ 添加成功！

已添加：
- 王建国（父亲）- 现居地：杭州
- 李桂英（母亲）- 现居地：杭州

父母已添加到你的花名册！
```

### 场景3：查看花名册

```
用户：查看我的花名册
Agent：📋 你的花名册（共5条）：

**张三** - 本人
  性别: 男 | 现居地: 北京
  出生日期: 1990年03月15日08时
  MBTI: INTJ
  八字: 庚午年己卯月乙酉日辛巳时
  出生地: 上海
  备注: 互联网行业产品经理

**李四** - 同事 (+1)
  性别: 女 | 现居地: 上海
  MBTI: ENFP
  备注: 部门经理，性格开朗

**王建国** - 父母
  性别: 男 | 现居地: 杭州

**李桂英** - 父母
  性别: 女 | 现居地: 杭州

**王五** - 朋友
  性别: 男 | 现居地: 广州
  MBTI: ISTP
  备注: 大学同学，现在在创业
```

### 场景4：搜索花名册

```
用户：搜索花名册中性格开朗的
Agent：🔍 搜索结果（关键词: '性格开朗'，共1条）：

**李四** (ID: 2)
  备注: 部门经理，性格开朗
```

### 场景5：编辑花名册

```
用户：帮我修改李四的信息，她的MBTI是ENFJ
Agent：✅ 更新成功！

**更新了以下字段**: MBTI

**姓名**: 李四
**关系**: 同事 (+1)
**性别**: 女
**现居地**: 上海
**MBTI**: ENFJ
```

### 场景6：删除花名册

```
用户：删除王五的信息
Agent：✅ 删除成功！已删除条目：王五
```

### 场景7：基于花名册的人际关系建议

```
用户：我的上司李四经常批评我的方案，我该怎么办？
Agent：根据你提供的信息，李四是你的直接上级（+1），她的MBTI类型是ENFJ。

🎯 **人际关系建议**

**ENFJ型上司的特点**：
- 富有魅力和感染力，善于激励团队
- 重视团队和谐，希望得到认可
- 喜欢面对面的沟通和反馈
- 对细节比较敏感，追求完美

**应对策略**：
1. **主动沟通**：ENFJ喜欢坦诚的交流，建议你主动找她聊一聊
2. **表达认可**：感谢她的指导，让她感受到你的尊重
3. **准备充分**：在汇报方案前，多做功课，避免被批评
4. **理解意图**：她的批评可能是为了帮助你成长，不要过于在意

**具体建议**：
- 可以这样说："李经理，我知道您对我的要求很严格，我很感谢您的指导。最近您经常批评我的方案，我想了解我有哪些地方需要改进？"
- 建议在私下场合沟通，避免公开场合的尴尬

希望这些建议对你有帮助！如果你需要更具体的沟通方案，请随时告诉我。
```

## API使用

如果你想通过代码操作花名册，可以使用提供的HTTP API：

### 添加条目

```bash
curl -X POST http://localhost:8000/api/roster \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "user-123",
    "name": "张三",
    "gender": "男",
    "relationship_type": "本人",
    "birth_date": "1990年03月15日08时",
    "current_location": "北京",
    "mbti": "INTJ",
    "birth_place": "上海"
  }'
```

### 获取花名册

```bash
curl http://localhost:8000/api/roster?user_id=user-123
```

### 按关系类型筛选

```bash
curl "http://localhost:8000/api/roster?user_id=user-123&relationship_type=同事"
```

### 搜索花名册

```bash
curl "http://localhost:8000/api/roster/search?user_id=user-123&keyword=产品经理"
```

### 更新条目

```bash
curl -X PUT http://localhost:8000/api/roster/1 \
  -H "Content-Type: application/json" \
  -d '{
    "mbti": "INTP"
  }'
```

### 删除条目

```bash
curl -X DELETE http://localhost:8000/api/roster/1
```

## 注意事项

1. **首次使用必须录入本人信息**：只有录入本人信息后，才能进行命理分析
2. **出生年月日时间**：本人的出生年月日时间为必填字段，其他人可选
3. **关系级别**：仅用于同事类型，其他关系类型不需要
4. **八字信息**：系统在生成八字分析后，会自动保存到花名册
5. **数据隐私**：花名册信息存储在本地数据库，请妥善保管

## 常见问题

### Q1: 我的MBTI类型不知道怎么办？

A: MBTI类型是可选的，可以先不填写。如果你愿意，可以在线做一个MBTI测试，或者后续添加。

### Q2: 同事关系级别怎么确定？

A:
- +1：你的直接领导（上级）
- 0：和你平级的同事
- -1：你的下属
- +2/-2：更远一级的领导或下属

### Q3: 能否批量导入花名册？

A: 目前不支持批量导入，只能逐个添加。如果你有这个需求，可以告诉我们，我们会考虑添加。

### Q4: 删除的花名册能恢复吗？

A: 目前删除后无法恢复，请谨慎操作。建议在删除前确认清楚。

### Q5: 花名册信息会同步到命理分析吗？

A: 会！Agent在进行命理分析、人际关系建议等功能时，会参考花名册中的信息，提供更个性化的建议。

## 总结

花名册功能是职场情绪充电站的核心功能之一，通过管理你的人际关系信息，Agent可以：

- ✅ 提供更准确的命理分析
- ✅ 给出更贴切的人际关系建议
- ✅ 基于你的社交关系提供个性化服务
- ✅ 帮你更好地理解和应对职场中的各种关系

好好利用花名册功能，让你的职场生活更加顺利！
